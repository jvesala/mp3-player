<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <title>mp3-search</title>
  <script src="http://www.google.com/jsapi"></script>
  <script>
    google.load("jquery", "1");
google.setOnLoadCallback(function() {
  var emptySearch = "Kirjoita jotain hakeaksesi...";  
  var searchString; 
  var search = null;

  $.fn.textEvent = function(type, func) {
    this[type]("keyup input paste", function() {
      setTimeout((function(instance, method) {
        return function() {
          return method.apply(instance, arguments);
        };
      })(this, func), 10);
    });
  };

  function setResults(data) {
    $("#results").html(data);
    $("#indicator").css("background-image", "none");
  }
  function searchTrack(query) {
    if(query == "") {
      setResults(emptySearch);
      return;
    }

    $("#indicator").css("background-image", "url('reikajalka.gif')");
    $.get("/servlet/search/" + query, function(data) {
      if(query == searchString) {
        setResults(data);
      }
    });
  }

  $("#searchstring").textEvent('bind', function() {
    clearTimeout(search);
    search = setTimeout(function () {
      searchString = $("#searchstring").val(); 
      searchTrack(searchString);
    }, 600);
  });

  $(document).ready(function() {
      setResults(emptySearch);
  });

});
  </script>
  <link href="/search.css" rel="stylesheet" type="text/css"/>
</head>
<body>

<div id="header">
  <div id="searchbox" >
    <div id="searchtitle">Hae sanalla</div>
    <input id="searchstring" type="text" />
  </div>
  <div id="indicator"></div>
</div>
<br/>
<div id="results"></div>

</body>
</html>
